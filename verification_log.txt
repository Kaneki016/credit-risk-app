2025-11-28 16:57:32 INFO     [root:41] - Logging configured. Logs will be written to logs\app.log
2025-11-28 16:57:32 INFO     [__main__:23] - Starting schema replacement verification...
2025-11-28 16:57:33 INFO     [__main__:30] - Columns before: ['id', 'created_at', 'updated_at', 'application_status', 'notes', 'person_age', 'person_income', 'new_dynamic_column_a', 'new_dynamic_column_b', 'person_emp_length', 'home_ownership', 'loan_amnt', 'loan_int_rate', 'loan_percent_income', 'loan_intent', 'loan_grade', 'cb_person_cred_hist_length', 'default_on_file']
2025-11-28 16:57:33 INFO     [__main__:39] - Calling import_csv with replace_schema=True...
2025-11-28 16:57:33 INFO     [backend.api.routes.data_management:38] - Importing 1 rows from test_dynamic.csv
2025-11-28 16:57:33 WARNING  [backend.api.routes.data_management:77] - Replacing schema based on CSV columns
2025-11-28 16:57:33 WARNING  [backend.database.crud:51] - ⚠️  Recreating loan_applications table with dynamic schema...
2025-11-28 16:57:33 INFO     [backend.database.crud:58] - Dropped dependent tables (predictions, mitigation_plans)
2025-11-28 16:57:33 INFO     [backend.database.crud:65] - Dropped loan_applications table
2025-11-28 16:57:33 INFO     [backend.database.crud:108] - Created new loan_applications table with 18 columns
2025-11-28 16:57:33 INFO     [backend.database.crud:114] - Recreated dependent tables
2025-11-28 16:57:34 INFO     [backend.database.crud:148] - Inserting with dynamic keys: ['new_dynamic_column_a', 'new_dynamic_column_b']
2025-11-28 16:57:34 INFO     [backend.database.crud:149] - Application data keys: ['person_age', 'person_income', 'new_dynamic_column_a', 'new_dynamic_column_b', 'application_status']
2025-11-28 16:57:34 WARNING  [backend.api.routes.data_management:137] - Failed to import row: (psycopg.errors.InvalidTextRepresentation) invalid input syntax for type double precision: "test_val"
CONTEXT:  unnamed portal parameter $5 = '...'
[SQL: INSERT INTO loan_applications (application_status, person_age, person_income, new_dynamic_column_a, new_dynamic_column_b) VALUES (%(application_status)s::VARCHAR, %(person_age)s, %(person_income)s, %(new_dynamic_column_a)s, %(new_dynamic_column_b)s) RETURNING loan_applications.id]
[parameters: {'application_status': 'approved', 'person_age': 30, 'person_income': 50000, 'new_dynamic_column_a': 100.5, 'new_dynamic_column_b': 'test_val'}]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-11-28 16:57:34 INFO     [httpx:1013] - HTTP Request: POST http://testserver/api/v1/db/import_csv?replace_schema=true "HTTP/1.1 200 OK"
2025-11-28 16:57:34 INFO     [__main__:49] - Import response: {'status': 'success', 'message': 'Successfully imported 0 records', 'total_rows': 1, 'imported': 0}
2025-11-28 16:57:34 INFO     [__main__:54] - Columns after: ['id', 'created_at', 'updated_at', 'application_status', 'notes', 'person_age', 'person_income', 'new_dynamic_column_a', 'new_dynamic_column_b', 'person_emp_length', 'home_ownership', 'loan_amnt', 'loan_int_rate', 'loan_percent_income', 'loan_intent', 'loan_grade', 'cb_person_cred_hist_length', 'default_on_file']
2025-11-28 16:57:34 INFO     [__main__:57] - ✅ Verification SUCCESS: New columns found in schema.
2025-11-28 16:57:34 INFO     [__main__:64] - Data verification result: None
2025-11-28 16:57:34 ERROR    [__main__:71] - ❌ Verification FAILED: Data mismatch. Expected 100.5, got None
